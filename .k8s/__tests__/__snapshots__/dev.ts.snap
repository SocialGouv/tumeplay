// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`kosko generate --dev 1`] = `
"---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    kapp.k14s.io/disable-default-ownership-label-rules: ''
    kapp.k14s.io/disable-default-label-scoping-rules: ''
    app.github.com/job: '5678'
    app.github.com/ref: refs/heads/mybranch
    app.github.com/repo: socialgouv/tumeplay
    app.github.com/run: '1234'
    app.github.com/sha: '0123456'
  labels:
    app: backend
    application: tumeplay
    owner: tumeplay
    team: tumeplay
    cert: wildcard
  name: backend
  namespace: tumeplay-mybranch
spec:
  replicas: 1
  selector:
    matchLabels:
      app: backend
  template:
    metadata:
      annotations:
        kapp.k14s.io/disable-default-ownership-label-rules: ''
        kapp.k14s.io/disable-default-label-scoping-rules: ''
        app.github.com/job: '5678'
        app.github.com/ref: refs/heads/mybranch
        app.github.com/repo: socialgouv/tumeplay
        app.github.com/run: '1234'
        app.github.com/sha: '0123456'
      labels:
        app: backend
        application: tumeplay
        owner: tumeplay
        team: tumeplay
        cert: wildcard
    spec:
      containers:
        - image: >-
            ghcr.io/socialgouv/tumeplay/backend:sha-0123456789abcdefghijklmnopqrstuvwxyz0123
          livenessProbe:
            httpGet:
              path: /_health
              port: http
            initialDelaySeconds: 30
          name: backend
          ports:
            - containerPort: 1337
              name: http
          readinessProbe:
            httpGet:
              path: /_health
              port: http
            initialDelaySeconds: 30
          resources:
            requests:
              cpu: 300m
              memory: 256Mi
            limits:
              cpu: '1'
              memory: 1Gi
          startupProbe:
            httpGet:
              path: /_health
              port: http
            initialDelaySeconds: 30
          volumeMounts:
            - mountPath: /public/uploads
              name: uploads
          envFrom:
            - secretRef:
                name: azure-pg-user-mybranch
            - secretRef:
                name: backend-sealed-secret
            - configMapRef:
                name: backend-configmap
          env:
            - name: DATABASE_CLIENT
              value: postgres
            - name: DATABASE_NAME
              value: $(PGDATABASE)
            - name: DATABASE_HOST
              value: $(PGHOST)
            - name: DATABASE_PORT
              value: $(PGPORT)
            - name: DATABASE_USERNAME
              value: $(PGUSER)
            - name: DATABASE_PASSWORD
              value: $(PGPASSWORD)
            - name: DATABASE_SSL
              value: 'true'
      volumes:
        - name: uploads
          emptyDir: {}
      initContainers:
        - env:
            - name: WAIT_FOR_RETRIES
              value: '24'
          envFrom:
            - secretRef:
                name: azure-pg-user-mybranch
          image: ghcr.io/socialgouv/docker/wait-for-postgres:6.38.3
          imagePullPolicy: Always
          name: wait-for-postgres
          resources:
            limits:
              cpu: 20m
              memory: 32Mi
            requests:
              cpu: 5m
              memory: 16Mi
---
apiVersion: bitnami.com/v1alpha1
kind: SealedSecret
metadata:
  annotations:
    sealedsecrets.bitnami.com/cluster-wide: 'true'
    kapp.k14s.io/disable-default-ownership-label-rules: ''
    kapp.k14s.io/disable-default-label-scoping-rules: ''
    app.github.com/job: '5678'
    app.github.com/ref: refs/heads/mybranch
    app.github.com/repo: socialgouv/tumeplay
    app.github.com/run: '1234'
    app.github.com/sha: '0123456'
  name: backend-sealed-secret
  namespace: tumeplay-mybranch
  labels:
    application: tumeplay
    owner: tumeplay
    team: tumeplay
    cert: wildcard
spec:
  encryptedData:
    MONDIALRELAY_ID: >-
      AgCTmV0sxKR7ZjwL8RSQrh6F+mtqqkwZsOzAZK3w3K4owLKlrrq5dwJrUcRY/pvFwVFtas6WyEGasVA7IGjnkO31S3yvE01W3bERwxWEAi1V/gkmlL+eCOCsJ5+b/DVJo49suemEZJ0CykZuuxWVbJM0cqXFiOioDnH35HsZPEf62D5nsVvrPMD57rjLU1a961/8/PEFm7y9niD/gfa8eBpTDUFdLwvJWiBKsVye8CYEFhsrfBl4lvbgv8aDHoJqk9kOh3XM1FIuCYrozWdagAaf1eg+gBC2NmFhyTXzXdKDJmVslJPQIctPojDFBA7jeZLR/6HBXnBml4U3chNUPqUgazoA2ur9RBfqaNZ9e1HEJbLtnV91WYMcBttxNMBSIGjcs6QxzC6MQrUehPjudTzswLNJeG0PW4tfbybxZOn3INVSFq62CMQbNajupkus1hKejKB/JUsBNBsL7LDmNpXfMVJ8XC0grKanzhErgN9deMg7CdFbHMoCjMqA0xaO1y/WEnuFYeYY/7/SseBhbWFuN9JqhdM8KFXDOflkZqlsJbf4+iLtn71/6YDouHpAlwwLZTwPuyM8jrvxXZCnbrzBgQsL1WpuoyQWIC4t/YJ0lS7A6B8WveN42psFLjOx1CX30zMk77oldx3njW4pukkMNG6h7ItM4SNA//uvfrpQ/Ef1nWjKzHRkvNSiCfE9UQrJ3R4ufdnGBw==
    MONDIALRELAY_SECRET: >-
      AgAKewcqqaSqyzuyCl9T+f7OnADH5DJnanNeeR3rlhUz+ukIKSbWIYhRrMCp4zclDwMl88T8zSnp1ju8nSv20jEgvUk8g9zJ354oVHZ4PBGeodtAtJKqltrjc3PFDXWRs3cCU4Rut3jCTP9z0tA5k5WUNRqi2vsTR+oDXnW3hCTDGs6fOXy8jLFM95mur3bj09IZL04lLNvyXlaEbzHLUr+wM4rLr4co06EEdI0kaXZLx2Ns8lkEroWwh7gh5XoL24LCKVsdYvUB7MS4Q0m+tQ5TX6Grhx7o9GqW2Qc+mMKkht78B4CKRcSB8pFPzW6RmHAChNTvFnAuOc1U/5K6zZk/mlJTwebxT1bZsEuoJ1tqVy9MZh71jyg97QTmpepDuSY0JM2sHip20/Lsvf4TyKdmLuY9G+oSbjJYtARWzzBtXvj6NQ4DMpSPAPAPnNBxGy3tXkqyLxsEnJ32gAcD2Qzg/asSqvZzLi0MyzP9RP+ve9/14qN19m4ChwbtkTIK5viEi/o585tUM+3sPChBhrkPk/07Efpm+qhkfzBY5fWF8smpyWelZa1+rtYS/vZb9d9YRPgBuEEvGaIgcAWJGGA9IzRMB+JphfhDxS4zDnUWDoRRY+bAyqAfk+zZq+3VvJ+5njyjY1PpcBerT4tFICRtlNOof6XNwTrqHDQ806Fat+296dMkfqEyVF1U5/zrE+1z3X2d10ZvZA==
    EMAIL_PROVIDER_PASSWORD: >-
      AgDEAbsDpdFX/nKL15CCy47ledwCSYjkZc+o/kcALZudXKA6ukPOnAjUS4PwS7QjSmf8xOt2SAMJSyUkHsGZ3UYo4NAXRgpvO+CfBqV5kImCIQN93op90W1wdKh8OnXb6QslHpAGFmlZ20RMp3XXecQJps6MnV+Hh7WzaYlWEukVmyniPaPLF0P8TvHii77k+dTW5BqSuRlgQRC8NBcXnrqVRHLjKGWYBlm/6bHipQwIaxvNbYfmVbiHULLfC1gokrcXDfQQRFRerzRT4V1enZcRVDs/e22XXjAsRTxW+NKulOds+RfxVud82CbzL7qW7/JQf72BhPR/NeTdJ11s8ULpTx3iQylg/3yWwIirPxiWykm7YFY121MZY+b6JNRGlbfTRriDu9e2n+EKVdlH4IveI0E1UNXdEb3HtmYpbgWUpMIQqBMr//sbPVkBNqqF9zcC/BPUGei81FxSnFWcmHorNXLrXrEbl+XG+6zUlf0DgCNMeHEuHZEUKU7G7vHgTJhenKMfM0Lu5YhjIHC9E7J2/N+ubVzw+NA2ITKGoJ9rNrxY2gDayA/tsV49Cv2y1NbN+/6GpeYORBjO9r82cU6T29tAySCyHAF2l1Va5Swu9cGJ+wyqIKG1Wpw/HZaWYbys74m6Eg1u3hWNGK566pJVb3HTzwgCc3FMd+sDR5BjV37XkHsrsYoL/cWMOVyiJ5fchZQJmACOLY9q5A==
    STRAPI_LICENSE: >-
      AgAm/3Rquh/2Sq+hcYeUVBdl+nJ5GSW4MCSdvBMrt7pATbV3cLft1j4HmtR4dzhnVeAap6X6a7HUGO/eqUcC6Ck4vPggtkgDV8QbtKP5BmGSZQVamnnu53+G1Z9v6unsPUBRK0n5bpqVrhnPVZq6lyZupu+tkWnImDMn7WWEyS/ZHtSjUI7bznCqGb/AJepy0iK9s67KNtMDIAQnyHSMnpvJ42LvNbCxs3Hc4exI7p08Qzu3id3wrA8i/tMhqbfihI1PeawYWZsKvoAB0PfOKTB0NU2VXbyG6zzX0oxxDiWaLKrS/K1bFpC7YsJWMviv4m6NR7nNsU+xv1PoXsdkFwH6xT992m+pVKmj97/702kdRRD2NN88dFsDFcuorlnDQIGzZOj/GZ/xgIWdkYcPMTeeAp8mAooO5lyr6qqH8zB5dDSfE0dDZujdo4XqBqjGuY6MC0lGzGegLhfgWd4vuHB49WeaW60tscewxkQHtOyDFFEMR4idXAwDziYo9jOcYhkVXb6yv7H84xtcUsIApFEzdg/U2a0WPaBjJcjgUM/v5kgdWdEesm4W4zjYgvnl2VFrMkaJWKolUr8zn/4S4MUEdEphV629FaY81drP7zhWMmjV9KAI4l4ns72lniJsT24r36PwgPth2GOsi9io1AMx3G9rbHgwnhA0FxGEsAAOKEsQNCQI5EWqxrbizbNzKve5qrIWuyaeNH1ZvAMgXxoEWTObiIakmFtBeUY86kWxS/q96XunQGY953sRUrw0Ps5NTHNJr2og1fiKuj5NBYuBmJgK/tUD/dKyRvq++kuCa55ewYM2Va6LMj0v0AlMfDN7vFf37BQxuLmMtbaBTFJc4iqYyDaeNt63074s/pz9CkCJNRzbrUSoR5xFlTwM09Hw72JVY3zhboVlwSWJT/lNMjnObNpOypjdrCbQsk8cNtPX83EYHt8mV4A40huYMlWP/aCbyzj37rsZS0CBKIGhYXYKKRRDWrj2SH+jzwqIXpsEhfgsm8j4fCmGcN/O9DO2SZSFpQ5jftOf973WUCsCttf66nvEwU7jtXCGPb1Ds5ZRV+/rj3vqKj4nrKQ3mWn9Rchbnzcz891PhbG1/Xk2PbcrfxUzOMSIRApTCJpHsU4rOpXlFA7i0fnmh6GBE1H1rdmArRUjAY53zmy1N92QoLj9Tve6YIiOBo9dxrVuH49ujEsIdwOvFpTQYSgWjZf61OvROeQ84iVyv7Yuf6sZmqyDqMXHkmGD0ACptUd0qAUtFI/Ndxxe0sm8RLterZ21ZAfemC2zsH44t942N/Oyer7L/HakdljUGKGNdG16KlmtZC1JaVEN5cgr4dzVLTZyKvBR1tMTm1L41MFjm3PDRS5isodvN/2hSqob62HinC7nrRD7ER7cfsVtsKBYfqhIxbSH+7oKTlO19QnlLZuCTcK8FkopGVUQuhmbqqkfxRvMNT4qMCScFAQIjcrmWzh0OQh5E5ZhNzZ8aevGsMyeMdYi8fjYNmVYxUS1usP/lYwa+kZWrOydlFnarovNbJCg6mPUpeBJCRD89vJxMoWB1UtK8+nWbfYGPXdm2J/j/H0tiPUbMHTEOcUXVJXwXuovMZBnRQGT0WcBbJ5UMU3kcVr06JPoToCnuZ73KyYTzQaDymhLzX0n4W3GEa/RhCALb9NMAehrkgWS4s8DWHirCzW5cgZXdA6zk9m3r5IJLsOE+NS9EGG73Gea1w==
  template:
    metadata:
      annotations:
        sealedsecrets.bitnami.com/cluster-wide: 'true'
        kapp.k14s.io/disable-default-ownership-label-rules: ''
        kapp.k14s.io/disable-default-label-scoping-rules: ''
        app.github.com/job: '5678'
        app.github.com/ref: refs/heads/mybranch
        app.github.com/repo: socialgouv/tumeplay
        app.github.com/run: '1234'
        app.github.com/sha: '0123456'
      name: backend-sealed-secret
      labels:
        application: tumeplay
        owner: tumeplay
        team: tumeplay
        cert: wildcard
    type: Opaque
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: backend-configmap
  annotations:
    kapp.k14s.io/disable-default-ownership-label-rules: ''
    kapp.k14s.io/disable-default-label-scoping-rules: ''
    app.github.com/job: '5678'
    app.github.com/ref: refs/heads/mybranch
    app.github.com/repo: socialgouv/tumeplay
    app.github.com/run: '1234'
    app.github.com/sha: '0123456'
  labels:
    application: tumeplay
    owner: tumeplay
    team: tumeplay
    cert: wildcard
  namespace: tumeplay-mybranch
data:
  RANCHER_PROJECT_ID: c-gjtkk:p-m77bc
  CRON_ENABLE: 'false'
  EMAIL_PROVIDER_HOST: smtp.gmail.com
  EMAIL_PROVIDER_PORT: '465'
  EMAIL_PROVIDER_SECURE: 'true'
  EMAIL_PROVIDER_USERNAME: cymittest@gmail.com
  EMAIL_PROVIDER_TLS: 'false'
  EMAIL_PROVIDER_FROM: Tumeplay <cymittest@gmail.com>
  EMAIL_PROVIDER_REPLY_TO: cymittest@gmail.com
  EMAIL_CONFIG_ADMIN: clement@numericite.eu
  EMAIL_CONFIG_CAT: maxime.lecoq@benextcompany.com
---
apiVersion: v1
kind: Service
metadata:
  labels:
    app: backend
    application: tumeplay
    owner: tumeplay
    team: tumeplay
    cert: wildcard
  name: backend
  annotations:
    kapp.k14s.io/disable-default-ownership-label-rules: ''
    kapp.k14s.io/disable-default-label-scoping-rules: ''
    app.github.com/job: '5678'
    app.github.com/ref: refs/heads/mybranch
    app.github.com/repo: socialgouv/tumeplay
    app.github.com/run: '1234'
    app.github.com/sha: '0123456'
  namespace: tumeplay-mybranch
spec:
  ports:
    - name: http
      port: 80
      targetPort: 1337
  selector:
    app: backend
  type: ClusterIP
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  annotations:
    kubernetes.io/ingress.class: nginx
    kapp.k14s.io/disable-default-ownership-label-rules: ''
    kapp.k14s.io/disable-default-label-scoping-rules: ''
    app.github.com/job: '5678'
    app.github.com/ref: refs/heads/mybranch
    app.github.com/repo: socialgouv/tumeplay
    app.github.com/run: '1234'
    app.github.com/sha: '0123456'
  labels:
    app: backend
    application: tumeplay
    owner: tumeplay
    team: tumeplay
    cert: wildcard
  name: backend
  namespace: tumeplay-mybranch
spec:
  rules:
    - host: backend-tumeplay-mybranch.dev2.fabrique.social.gouv.fr
      http:
        paths:
          - backend:
              service:
                name: backend
                port:
                  name: http
            path: /
            pathType: Prefix
  tls:
    - hosts:
        - backend-tumeplay-mybranch.dev2.fabrique.social.gouv.fr
      secretName: wildcard-crt
---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    kapp.k14s.io/disable-default-ownership-label-rules: ''
    kapp.k14s.io/disable-default-label-scoping-rules: ''
    app.github.com/job: '5678'
    app.github.com/ref: refs/heads/mybranch
    app.github.com/repo: socialgouv/tumeplay
    app.github.com/run: '1234'
    app.github.com/sha: '0123456'
  labels:
    app: guyane
    application: tumeplay
    owner: tumeplay
    team: tumeplay
    cert: wildcard
    component: nginx
  name: guyane
  namespace: tumeplay-mybranch
spec:
  replicas: 1
  selector:
    matchLabels:
      app: guyane
  template:
    metadata:
      annotations:
        kapp.k14s.io/disable-default-ownership-label-rules: ''
        kapp.k14s.io/disable-default-label-scoping-rules: ''
        app.github.com/job: '5678'
        app.github.com/ref: refs/heads/mybranch
        app.github.com/repo: socialgouv/tumeplay
        app.github.com/run: '1234'
        app.github.com/sha: '0123456'
      labels:
        app: guyane
        application: tumeplay
        owner: tumeplay
        team: tumeplay
        cert: wildcard
        component: nginx
    spec:
      containers:
        - image: >-
            ghcr.io/socialgouv/tumeplay/frontend-guyane:sha-0123456789abcdefghijklmnopqrstuvwxyz0123
          livenessProbe:
            failureThreshold: 6
            httpGet:
              path: /index.html
              port: http
            initialDelaySeconds: 30
            periodSeconds: 5
            timeoutSeconds: 5
          name: guyane
          ports:
            - containerPort: 80
              name: http
          readinessProbe:
            failureThreshold: 15
            httpGet:
              path: /index.html
              port: http
            initialDelaySeconds: 0
            periodSeconds: 5
            successThreshold: 1
            timeoutSeconds: 1
          resources:
            limits:
              cpu: 500m
              memory: 128Mi
            requests:
              cpu: 5m
              memory: 32Mi
          startupProbe:
            failureThreshold: 12
            httpGet:
              path: /index.html
              port: http
            periodSeconds: 5
          env:
            - name: REACT_APP_API_URL
              value: https://backend-tumeplay-mybranch.dev2.fabrique.social.gouv.fr
            - name: REACT_APP_ZONE
              value: guyane
            - name: REACT_APP_OTHER_ZONE_URL
              value: https://metropole-tumeplay-mybranch.dev2.fabrique.social.gouv.fr
---
apiVersion: v1
kind: Service
metadata:
  labels:
    app: guyane
    application: tumeplay
    owner: tumeplay
    team: tumeplay
    cert: wildcard
  name: guyane
  annotations:
    kapp.k14s.io/disable-default-ownership-label-rules: ''
    kapp.k14s.io/disable-default-label-scoping-rules: ''
    app.github.com/job: '5678'
    app.github.com/ref: refs/heads/mybranch
    app.github.com/repo: socialgouv/tumeplay
    app.github.com/run: '1234'
    app.github.com/sha: '0123456'
  namespace: tumeplay-mybranch
spec:
  ports:
    - name: http
      port: 80
      targetPort: 80
  selector:
    app: guyane
  type: ClusterIP
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  annotations:
    kubernetes.io/ingress.class: nginx
    kapp.k14s.io/disable-default-ownership-label-rules: ''
    kapp.k14s.io/disable-default-label-scoping-rules: ''
    app.github.com/job: '5678'
    app.github.com/ref: refs/heads/mybranch
    app.github.com/repo: socialgouv/tumeplay
    app.github.com/run: '1234'
    app.github.com/sha: '0123456'
  labels:
    app: guyane
    application: tumeplay
    owner: tumeplay
    team: tumeplay
    cert: wildcard
  name: guyane
  namespace: tumeplay-mybranch
spec:
  rules:
    - host: guyane-tumeplay-mybranch.dev2.fabrique.social.gouv.fr
      http:
        paths:
          - backend:
              service:
                name: guyane
                port:
                  name: http
            path: /
            pathType: Prefix
  tls:
    - hosts:
        - guyane-tumeplay-mybranch.dev2.fabrique.social.gouv.fr
      secretName: wildcard-crt
---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    kapp.k14s.io/disable-default-ownership-label-rules: ''
    kapp.k14s.io/disable-default-label-scoping-rules: ''
    app.github.com/job: '5678'
    app.github.com/ref: refs/heads/mybranch
    app.github.com/repo: socialgouv/tumeplay
    app.github.com/run: '1234'
    app.github.com/sha: '0123456'
  labels:
    app: metropole
    application: tumeplay
    owner: tumeplay
    team: tumeplay
    cert: wildcard
    component: nginx
  name: metropole
  namespace: tumeplay-mybranch
spec:
  replicas: 1
  selector:
    matchLabels:
      app: metropole
  template:
    metadata:
      annotations:
        kapp.k14s.io/disable-default-ownership-label-rules: ''
        kapp.k14s.io/disable-default-label-scoping-rules: ''
        app.github.com/job: '5678'
        app.github.com/ref: refs/heads/mybranch
        app.github.com/repo: socialgouv/tumeplay
        app.github.com/run: '1234'
        app.github.com/sha: '0123456'
      labels:
        app: metropole
        application: tumeplay
        owner: tumeplay
        team: tumeplay
        cert: wildcard
        component: nginx
    spec:
      containers:
        - image: >-
            ghcr.io/socialgouv/tumeplay/frontend-metropole:sha-0123456789abcdefghijklmnopqrstuvwxyz0123
          livenessProbe:
            failureThreshold: 6
            httpGet:
              path: /index.html
              port: http
            initialDelaySeconds: 30
            periodSeconds: 5
            timeoutSeconds: 5
          name: metropole
          ports:
            - containerPort: 80
              name: http
          readinessProbe:
            failureThreshold: 15
            httpGet:
              path: /index.html
              port: http
            initialDelaySeconds: 0
            periodSeconds: 5
            successThreshold: 1
            timeoutSeconds: 1
          resources:
            limits:
              cpu: 500m
              memory: 128Mi
            requests:
              cpu: 5m
              memory: 32Mi
          startupProbe:
            failureThreshold: 12
            httpGet:
              path: /index.html
              port: http
            periodSeconds: 5
          env:
            - name: REACT_APP_API_URL
              value: https://backend-tumeplay-mybranch.dev2.fabrique.social.gouv.fr
            - name: REACT_APP_ZONE
              value: metropole
            - name: REACT_APP_OTHER_ZONE_URL
              value: https://guyane-tumeplay-mybranch.dev2.fabrique.social.gouv.fr
---
apiVersion: v1
kind: Service
metadata:
  labels:
    app: metropole
    application: tumeplay
    owner: tumeplay
    team: tumeplay
    cert: wildcard
  name: metropole
  annotations:
    kapp.k14s.io/disable-default-ownership-label-rules: ''
    kapp.k14s.io/disable-default-label-scoping-rules: ''
    app.github.com/job: '5678'
    app.github.com/ref: refs/heads/mybranch
    app.github.com/repo: socialgouv/tumeplay
    app.github.com/run: '1234'
    app.github.com/sha: '0123456'
  namespace: tumeplay-mybranch
spec:
  ports:
    - name: http
      port: 80
      targetPort: 80
  selector:
    app: metropole
  type: ClusterIP
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  annotations:
    kubernetes.io/ingress.class: nginx
    kapp.k14s.io/disable-default-ownership-label-rules: ''
    kapp.k14s.io/disable-default-label-scoping-rules: ''
    app.github.com/job: '5678'
    app.github.com/ref: refs/heads/mybranch
    app.github.com/repo: socialgouv/tumeplay
    app.github.com/run: '1234'
    app.github.com/sha: '0123456'
  labels:
    app: metropole
    application: tumeplay
    owner: tumeplay
    team: tumeplay
    cert: wildcard
  name: metropole
  namespace: tumeplay-mybranch
spec:
  rules:
    - host: metropole-tumeplay-mybranch.dev2.fabrique.social.gouv.fr
      http:
        paths:
          - backend:
              service:
                name: metropole
                port:
                  name: http
            path: /
            pathType: Prefix
  tls:
    - hosts:
        - metropole-tumeplay-mybranch.dev2.fabrique.social.gouv.fr
      secretName: wildcard-crt
---
apiVersion: batch/v1
kind: Job
spec:
  backoffLimit: 5
  template:
    spec:
      containers:
        - command:
            - create-db-user
          env:
            - name: NEW_DB_NAME
              value: autodevops_mybranch
            - name: NEW_USER
              value: user_mybranch
            - name: NEW_PASSWORD
              value: password_mybranch
            - name: NEW_DB_EXTENSIONS
              value: hstore pgcrypto citext uuid-ossp
          envFrom:
            - secretRef:
                name: azure-pg-admin-user
          image: ghcr.io/socialgouv/docker/azure-db:6.38.3
          imagePullPolicy: IfNotPresent
          name: create-db-user
          resources:
            limits:
              cpu: 300m
              memory: 256Mi
            requests:
              cpu: 100m
              memory: 64Mi
      restartPolicy: Never
    metadata:
      annotations:
        app.github.com/job: '5678'
        app.github.com/ref: refs/heads/mybranch
        app.github.com/repo: socialgouv/tumeplay
        app.github.com/run: '1234'
        app.github.com/sha: '0123456'
      labels:
        application: tumeplay
        owner: tumeplay
        team: tumeplay
        cert: wildcard
  ttlSecondsAfterFinished: 86400
metadata:
  annotations:
    app.github.com/job: '5678'
    app.github.com/ref: refs/heads/mybranch
    app.github.com/repo: socialgouv/tumeplay
    app.github.com/run: '1234'
    app.github.com/sha: '0123456'
  labels:
    application: tumeplay
    owner: tumeplay
    team: tumeplay
    cert: wildcard
  name: create-db-job-0123456
  namespace: tumeplay-mybranch
---
apiVersion: v1
kind: Secret
stringData:
  DATABASE_URL: >-
    postgresql://user_mybranch%40tumeplaydevserver.postgres.database.azure.com:password_mybranch@tumeplaydevserver.postgres.database.azure.com/autodevops_mybranch?sslmode=require
  DB_URI: >-
    postgresql://user_mybranch%40tumeplaydevserver.postgres.database.azure.com:password_mybranch@tumeplaydevserver.postgres.database.azure.com/autodevops_mybranch?sslmode=require
  HASURA_GRAPHQL_DATABASE_URL: >-
    postgresql://user_mybranch%40tumeplaydevserver.postgres.database.azure.com:password_mybranch@tumeplaydevserver.postgres.database.azure.com/autodevops_mybranch?sslmode=require
  PGDATABASE: autodevops_mybranch
  PGHOST: tumeplaydevserver.postgres.database.azure.com
  PGPASSWORD: password_mybranch
  PGRST_DB_URI: >-
    postgresql://user_mybranch%40tumeplaydevserver.postgres.database.azure.com:password_mybranch@tumeplaydevserver.postgres.database.azure.com/autodevops_mybranch?sslmode=require
  PGSSLMODE: require
  PGUSER: user_mybranch@tumeplaydevserver.postgres.database.azure.com
metadata:
  annotations:
    app.github.com/job: '5678'
    app.github.com/ref: refs/heads/mybranch
    app.github.com/repo: socialgouv/tumeplay
    app.github.com/run: '1234'
    app.github.com/sha: '0123456'
  labels:
    application: tumeplay
    owner: tumeplay
    team: tumeplay
    cert: wildcard
  name: azure-pg-user-mybranch
  namespace: tumeplay-mybranch
---
kind: SealedSecret
apiVersion: bitnami.com/v1alpha1
metadata:
  name: azure-pg-admin-user
  annotations:
    sealedsecrets.bitnami.com/cluster-wide: 'true'
    app.github.com/job: '5678'
    app.github.com/ref: refs/heads/mybranch
    app.github.com/repo: socialgouv/tumeplay
    app.github.com/run: '1234'
    app.github.com/sha: '0123456'
  namespace: tumeplay-mybranch
  labels:
    application: tumeplay
    owner: tumeplay
    team: tumeplay
    cert: wildcard
spec:
  template:
    metadata:
      name: azure-pg-admin-user
      annotations:
        sealedsecrets.bitnami.com/cluster-wide: 'true'
        app.github.com/job: '5678'
        app.github.com/ref: refs/heads/mybranch
        app.github.com/repo: socialgouv/tumeplay
        app.github.com/run: '1234'
        app.github.com/sha: '0123456'
      labels:
        application: tumeplay
        owner: tumeplay
        team: tumeplay
        cert: wildcard
    type: Opaque
  encryptedData:
    ADMIN_PG_PASSWORD: >-
      AgCRJRRg8+rSzLmCh4ZaFdbybYkpAMZ6Kg1OxK614mudoO7CuF5WQA0shg9Hw5rQJBlb4Y+v92kGssKnR117IzPNUACr2F1xgXLpfgqR3oqZUSiKsNMsn0LD1pDWNksRgGI5IxkwVffNNIoFT8hDahWXtP7Itom+JdCxDIOfMhK+KZvlf7oDbHfQ0IBMPEzuIl09KZjeIuQRQVZkzVzWJjA6ae9pd46pVeZISW07Vor0whT8JmbdTARqDpfsr3VK7MbuB0BamkNOwsE5hkHt1rVD4XdNoeXZTGaZDxEwRQ1X7Cdt1lPKMSXX0egcNavpITizloKlp5aw3OIpnYyyHe1FuopGWTHj2HPpQUA+u1WLjyGfOmIuS5ikdKZO63Hxq0jWQ28BmbaQEkTdQZKs7ZR1kgmJ8aDlhJq87ONdW5r4IfFVZ6QzspBBvbBQMW6/H16PD/yirUWLq3ZdqeWqRP0Yf1319E9UlGeolQ6ifGg3tLia7etg4KUG4lKvhqFRQ+H1fkNeRYaNGr57UrtZKNQJzseDm+kNtsjAUBR0HweknJhmphyu9vcgTinUfK6L1jODLT2HQaDPjMlyyzQC3tgvClL5yu06Gu1lZBhfmE7G7Rk9CLbi7iGPoWF27p7oD5XECLevCk3FdxMPbXT0xm9ClcaODMO0YpoOsGkLY1EKah3rbotrNwd0lFYTbIGlicPjlZA9cUgb8/buuYbzc9M=
    ADMIN_PG_PASSWORD_ENCODED: >-
      AgBhzHxZ8bqxgDL3hCj6SonGpuyWk3zmFbBwe5WPzj0JeUGbhT0PZGNL1VKNdxfXDBzQsGOSeF76agVT2Oy6cGojB3s7zXaJUSXhLSRJA2/icDNiyWcLg+FQzIhw2AHE7R56u4gEAwXB5XHXTCA70Id/Uz5LDopgE60rAij1lD/5JdIoVy0EKtKvzRbS+bV0LGHm1828GDyUYOcx4Oict3k31AKOoNjqqLHCMLFKJSCVUoobu3YzmLWPmBUNlRF7Q60tSTS6elLhzIC4K4q3a3dMjfhIWjAyzLcp8TJYZV78Kntq5t9kAHV7czEYLbt0C/6OKbgU59g8mXyaA5u5Fczs2boTQ6MHQ5PTq4YIfzkjyblvP6S+M3O/HCcmd/frrQCQu+46NQynxehBfm5BA+x1JR4KgAJkg8TzqjlMSMlNQiGdJYfJbdAAwBdczsuNFBBs0e+fMmn+IZ+0xeSvlsw3BZ33HELgqS37nHzJFYGdmlJxfoO7NZbdBZbEXw63FtY25wMVOCLkIN2ZeFz+1yWlH/ZT7xNcXPAFQtecYARLe67rf3Ypra1Z0hI7j0sF+Cz+jJZEmLBkuP4lec3ZLLdzEINVBY1jqgLBmP3wqFHX2qz23XUpPgv3hfrKM3JfeWa1f+JEjymQ7g68RipsO0vNHlZmFgSG4mVRpck3wyO3d9pxb+WkcruGaVFv869I6tABM3FHx+U5DJfu1CkAlVA=
    ADMIN_PG_USER: >-
      AgBnye/R0JZJVruWJyAtkU13h/JuRQUlNwD4he6dLn/P1bkw+dcsyNCwmoqnwRTxr7uiUKKTwlffdToTU0RL8YWNGwNW+bCdDL/OMR10p2PrP0t7Eb6kMF6KpfkEIuDOC1I/PpZiOndmc/VC1JPYZejsCxES1MFxhQhcnw+CyoyQJYaW02TljM+sN1eA9wJQ4tN4fEmwIypytzMF3xTYVDFvCwDW7D/N4gIE0jTmUAKwANxyK+skitnwRuZ49FUBQ17XNAYBF+/D8e6ZIBV8MAzWHmYEREUdc0oWvFFp8Pkf8QNJYbEpEmzkdvR2iIp5NXwMxhptF/MQhUKcAdHauIBGGYdJWBdKRZugeplxqYQlsRTc1ZOTNB4yDkcqtoH9iSChUSfr6YjeY72YGbuop65xiR13lMcpV5sMSA9sy+B8VYC5ULqTye7NB2G3bq4JcazMZD4ZIw/3qC7v4BGrgjg3Xu5W/pU2fMFSs2ZkDb8P2m1Ugq1cO7P9L9qsqZZSJiIn0avonWIE0CT7cuk623enWJU6jisnjh2jD+omfOLayL3ObsErKysDwFr5u5yNkpXA2GYo61xwWqWEg/mKlJLe1VpWVwWB9SwQyGKer+w85Cg2OzfF0e5l7tmLhxF6557B5+g837OTo9iaM4LhzdNeKYu4x7uZjz+gxI/QDEYJ3EFmz0uryWAn018f24pZJT37I2nJz29m7J0u+IIMczFpnTqP0eb3yiepvFOLUFK4
    ADMIN_PG_USER_ENCODED: >-
      AgDM0tBb0UhkFOlecjwm4dhNNWvQ3rnY8Nz7Ckv9kQRqlLlrmROMW1k60C1oLTP/vdSaa1SUK+92bfb89EfiPtVt35+8PI+7+dJneEnzRNQX2aPXZegSwgdX0g9enK+oryXy2nRuZmVxeHxFj9SAILQeUVsi6mlFEHqxe5W25CYtTZsDVyux/4xzNmb29lM0cnux6faG3qNdJCZITnrMMPqWEStchK8l/PubD2vE6aADr0ZlUpFbG+6rPICJGf3Scui5RUF1B1thY4oL04Txo2vzjUeDzopBjQ13JfNcUAyw5S2zVqLLyr0tSPgTRLru4Bb2NnDn6fRizeQAloKVBKaGOlHB8GEA7Gkbyvib+j3ocHxwCPuUdtiWCnGKi0rXqBBA7Bi49kFRxgu6/p2GAzBtfeZ5X/Lg+SjFzMjMQE3QDD5ZjOb6C6e3Mk/ZLFxpsCio4srEOk51bOns/nl79O716paSf7tU/WjhtzPO28nMDBZxvgtL9Fk1dEIARIgHYfZBJdDC5JL7FW6cTaBoQKmEq/SVRna/gsYhUvep1vjv4v1f5TRxs7p5eojI5iH+vhw24ji3cAa0F1/16Rco7GnD/QY7OrxtbhNm6NDBCjV9pY3bBOC50reZy8YLcSRxWCrtqJePeMfzEV5/cmH0+DM+ohDuZQehBKSvOTP/uP04ZTApoJYYmqvCMXAyhI5LHlCH4OGRf3gchvcUU/7WBnAo5geR2pD095jvFP2VUXTbkeo=
    DATABASE_URL: >-
      AgBg/ZsYAXzEir0kmv7c7Y58MTJutxouLfdGRjkr6Rp+JeIjrMOCQXMLDHHCo6mFzy7PjpMoc9LnAmvLe/8LOdGLwDfvsRT2uU4MgvF8ymTKbSFplzJnP6uS2Sb/gqESEeWg0sETzZExq21NJPEbz7gdCYiqAs3ELMX7YsmE5GTNJiUWXFBNVYyhwpM9BqVSw61/t4vcQwyN15JDR+JaEeu7DdTW8Pk2B8xp7uTaz4pAvwxlKgpkOWXUNsCdfgTDnYHGxVb1nxff43bZA59jt3uNqnXHGcaRCMrWWX22/jW78jv3Efc44nVKZwvCyvKgwJQMLAqlLbHF8U/5vIEziZpsFJqCQy5Yx98Rxgc0NftRW6uHxjZ4aYxHPquTtHAov1Ft7TuDPX9aBk0BuDIJA6xCuO6+fs0LSEWeO8uTQ9Glpo5n1GECsjc3flG6+7ZGL9Z2XUf714VNxJhfjrgkbxLG3qYu/eeoxjkz873QQ+jl/13gRSt6EDsA7nd3/rpaIzVNLKHzFYrFGzerkK9F/FSnI1X/jMhGARODR8oD0HeWfZQfDC3UupiGGFqwhI87vbA0Z9lonZ6H7aq9i4GYeSpjAyNIHIQw8AJOJ0120JfVdUGiXwZX19/kV7bwtIIKQ5iPItoeB6xRQkg/PJiZlHWERrLlVglqciuWWjQDk7uibBjGSjYh0TTt8SwEh55YGsCEVEm7u0vH6IB1KfqhqW9bs0geV+kswIWKWUJD8E45eIvdp8rcFAvW1G2wd+OXtCGSxqYNInwlZ0eLBPq1r0SVt7rYVa1ScAF9plsgJF3oxoBWpxsAlvk53s9tWYKbK01qD5WMKPAg9m4tnds=
    PGHOST: >-
      AgCS1yS5Tx+kikZuftVi4qx7kxZWEjsI8ZwbkTQjEtSe60dam8b6TtlX5ZxLX3+eM2CN5ZwPXVT4LTeTBomUdFy8NOjtazRj6Jn/YDasAADTZislUS6nkln1Q8nuBU3mWOL+use0NbFHGCO6omeI5QdC6fycAscyQ5h9n1VtUtZa4XzTvP64UlPWCTDoKNTloGjoHfPmB04NJcVe29ARVB5HgYVbfpWoa5DGnaQF2bUXgGINz0ClbPih87ty4EiM6FEy4UzRY5n2rb0HzpVXnhOqD+75R+HHwRdM1Hd7sdIBvbUryVKOLH1hj+XnzxPGOLkURcXyHlbUfFe48GIOGw66hYa7mRWcsigpirBuO+gj2CdWQnSKrFMqnf7vymXNd0QG8u3Uh93vtO8jOR1v6LoyxDmdxbq/bdmcyuCAz3/07cPVjvHA4GlmX/r/ZNX0rClUW8WkPavLRLy1JsblDFL445RmcIjr+FC8vNUbkicfvPxqlkWvtyLR9LV5Nl77O454MbPenuyOTCYlA4c8zsYUbkf0ajHt0nra1CQW4ZXE75TKHdP5lSii0E4oA3rngKr422m4uan0kpxbmozrEdCrN9nzfF3yXvhWZXUifM0eSRreysQmrjL4DWsjr1Os/a905NmcjlfLhQ8z6nt5phVI9U7Sts+v4qtYPhNY5Eln3+kLF6a9nx5mn9kfUkJKrjf//DLChVOvVKO0VhGzCumATdC1UptFbSlYE+h+KxYQ+IyjoGHI+l2EStB/sZ4=
    PGPASSWORD: >-
      AgA2gjuh2fnk5xO81fS3qOMEeHupdPfHNekXh0FySd6V//a6RrY+QqlyawlWMcISxyf1Slja410My+lWf7U5V09GvK2sy1b0NvzBh0lUTj7k78yGgzvZ/Kvyw0TvfMs3qUgSgY0+aebSJ4AsVWE3jg2XZ+yHHjv0FACTLKkAL42e9Smhg/nlsL3XLuseSsGoEqsqGteGXfug0qc+SFPe7x//q3H+06CKMQ1jU30MFDyNAjXb7Ouuh9ELFEwjHpCydecUBMBQ7B/sRLhPfF1vp0yGq+N2AcKdv/jyZmo5fnJr0imyTVchzhnu9h1iV8mF5SsMksBP9Nh7JOQt/N5eL/3en66OBhpDmQbwSk990R94qHm6xhwLrUzY8i+coYqTrory4q5pJ97zQlAZRGLDnPJbayCdg4SuJjsGQktuVSyuVctPvCRE52CTeovbY2Av5BUxT746i2QwH3bkJvBqAnrQ8Ih8tzRKd1Q7GYXra/EjZC6+hA0M3IyerkRobfDpjYt6N8P6E7ya2Jdjj/CsGSfc2HFWGMYPSO+LZFBbAJR5FlXK0VNGn7CZIMYsh2wZepzsEJE+8ex4uyQk7YXptV+59CF0jia6FHDSYtOcp7htAWLKAZ24ReewiGhRgy+QRzVmgNAj4A8La01HvKBB5GsLIRZuzwudwbc1UxcuIOLHYDG+0YEavcYBfTg2qMVbu+gfp5jjKYHSvNEpigePpJA=
    PGSSLMODE: >-
      AgAp63YeHGEWLXnDlQPNrIqEft94IHAJ7G9Aj7lOFxzNPonIPD2BgL53z9q2oPCWV/UoPVa5BuYVApbjjEBCOTlFvlbYHLIE7akAlCtkvRDGYur6A9WhZwinTFqYOw2UGtcXoauLOOxCuuRwuI7x/aoKyf+mKqBiNyITTo/bplU5sTSFZLN8M5+8Ca3Au0D/9FK7gj7tEo5CMkbyeFYINEhjRfUrdnFo4qnFuGc5my76DMnS4bmcm4mYWXaXUPF/SHb4rDEHKPaa1jcwpr+of7pbbptspZ+vjLPNgfj7ErLEWdfFRHBYjiq+Hi+SWBXzWPr3uuGtvG6P8yKQdoNSu0w4tkWHA4an14dLIxXAjWQMDL7GX9my87rNKnz7F/HobetCBIF+AVVdEWgc/VXLwPly7teSqrnfOfxbqUCCu26tPK3GuXZRdvHUBLV7QSBP0qIACGjnz2nVF0WWExfwXI0s23JfAkZ5K8o9erel517XRjLa6QqanXVumTOzng7JR46AKWluqt8r+bwVvkEiaz4sZNKf6AzU9RwutKrEQddH67Borcxpl2rXf0jC4oye3N8OG5v5Aj/H6gn1ii6xbN8t3iVqtSn4VRk0G/pLeVFTt1XLVAc/GE3xFUfibem9ugOGg+A8b2yenvCQDw2FO0WU0E3Atwq0vWz5v2T/AROJIfyAPng1k9o4KZs8jIZmLretZRTTyZdP
    PGUSER: >-
      AgDL0Ly2ZxzCOEIKQ6lTaqsUbqZBuKy3ne71l5RvIB/TVyPlY9mO6/L3rrAJcPIF0f5O0kqVMBbtIAAmdjWw9ZaUVTa1/mzPj38UuSpaHuGEiLPf2US/Z21H95pCo1ablDBa9rCOyS9VUTxKq66jrGtdeMk1GsOYxafrzqCvg1kzNx77OIAWP0ia9fVGLlPEfd513BtAMqJHoAZBvFsxRaGZpYuj6OVlevWkBJuCvdVOgmgAYrCQJVmi65C1D0NgntkZSQDNaK8r2SXlGUvTGU1M2hia5aCvxqs16IX+fkPxBVRnvs8/B2CQyLbBssLG8edLziECriBoIP8k432DxTdRPy2PxizP9V8mLuBRX15QjPtyoeLBwG+QOdaDt1aFnxAdGNSMWHA8084twKIMLIofACYVutS/eMtjQDaREkD9saM4fz6looEKdlHDSfPmeVGa7aBl+bZVdTKVM+UY+BQeNE3hd8Kr2uwFn0ufwW8vHaTecV1Djw+chXJPyS42FsuCK0U3ZBtrv2a/6eMX8/P3AApYZBd9WAP5/JFHdsrWWtQhGeR8oXmMh2hDJ/unzi36cD3Q0ezkgZjNAUNGIqo85A/Kf0v1KMYFAy3o9ZDNhtdE4O7uj1TdZ9qR0GGMtV3DK6y34odgMprs4pubP5J/FfzLL/6xvnUsQtOIATn4CpAzI82829EEGU4l/TaormDv1hkvsUl3v5EY0e1835slWj1j3KFgm7OcXe63htHz
    PG_HOST: >-
      AgBHKsM92qAc3f6OdVhHhPBt9UtMtyjoaNlpuHbJpSPiR0WPg7iLmbPoYDfQOPN+nI7LUElXpmfpMGazng1K1uHlc4LVoEBq7OoB8ULRq9HD1+n32rLUiZI4C2M/pWc9Z3ityi0qj1Rm9gmpCN91iDT9wP80rQNyBHrKHciEuabz9DtZ1cQmotdAEdLiMRwjFnvfNpIhdw8zdapHzLoaRAK0NcbMekiAqsgiNjQ8pRLxjhG+YPzBOBMIIf7lGUq0/7KRrIY+w4RIcEmsNoFmMOG+7BeO8OhWC0XCBh/AdRi1MoE3joOSaMEZ+FntzjnEHR0vXV7LU38QJ+BQARokaetX9HcFHB8tfAkH7oyTCSLBH3KL5m8Bsy7T8WpgIbsKOB8PnW725jIirZmSbrnJSJRKAjfOOPG0UmF6OzdLYPI2fua+F5684ylJTgelJPPf2x1iSjZaQkFI6eNVQKVYKlE+AfQ5yL/K11fhu5NnD/Oc/rQVhyW4+z0uhpCh9Nb3HYAc5inL86ZdJaEnajsz2h785LaGxcnbLhFySIGP/l5DaBq63JccpWLFNXUl8Tq97wapo/pkVb8404ciqcOflIjH3CRLZ4hI8bUmKZtwVC2o0OegEyadKB7AwliRYPvSBUpfe1ps/KTmyYiq3NXYX1mcRP/s2K7LsgqDruMOhxj3Wu8V8OcTUcps78ADfe7aXAYdNkKsND/wA+Wgh1D67Q1Gm54q/XaP9HGOdktkPCnAYrxk4HUrERvYo+x6vYI=
"
`;
